<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>高性能javascript | Ru Shui</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="/Blog_vuepress/assets/img/logo.png">
    <link rel="manifest" href="/Blog_vuepress/manifest.webmanifest" crossorigin="use-credentials">
    <meta name="description" content="To Build Amazing Things !">
    <meta property="og:url" content="/Blog_vuepress/cate/fe_base/javascript_base/high_performance.html">
    <meta property="og:site_name" content="Ru Shui">
    <meta property="og:title" content="高性能javascript">
    <meta property="og:type" content="article">
    <meta property="og:locale" content="en-US">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image:alt" content="Ru Shui">
    <meta property="article:author" content="ru shui">
    <meta property="article:tag" content="frontend">
    <meta property="article:published_time" content="2021-04-06T00:00:00.000Z">
    <meta name="keywords" content="frontend typescript">
    <meta name="author" content="ru shui">
    <meta name="theme-color" content="#46bd87">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    
    <link rel="preload" href="/Blog_vuepress/assets/css/0.styles.1e0213a7.css" as="style"><link rel="preload" href="/Blog_vuepress/assets/js/app.61d23203.js" as="script"><link rel="preload" href="/Blog_vuepress/assets/js/layout-Layout.90c0d5fc.js" as="script"><link rel="preload" href="/Blog_vuepress/assets/js/vendors~layout-Blog~layout-Layout~layout-NotFound.ec13e494.js" as="script"><link rel="preload" href="/Blog_vuepress/assets/js/vendors~layout-Blog~layout-Layout~layout-NotFound~layout-Slide.3b3ec8cf.js" as="script"><link rel="preload" href="/Blog_vuepress/assets/js/vendors~layout-Blog~layout-Layout.d8d83bf7.js" as="script"><link rel="preload" href="/Blog_vuepress/assets/js/page-高性能javascript.272df5f7.js" as="script"><link rel="prefetch" href="/Blog_vuepress/assets/js/70.d6c954a2.js"><link rel="prefetch" href="/Blog_vuepress/assets/js/71.77683d4a.js"><link rel="prefetch" href="/Blog_vuepress/assets/js/72.fdbd1d3a.js"><link rel="prefetch" href="/Blog_vuepress/assets/js/73.6d8f9001.js"><link rel="prefetch" href="/Blog_vuepress/assets/js/74.a6cc0b35.js"><link rel="prefetch" href="/Blog_vuepress/assets/js/layout-Blog.0d51c7d2.js"><link rel="prefetch" href="/Blog_vuepress/assets/js/layout-NotFound.e94ce152.js"><link rel="prefetch" href="/Blog_vuepress/assets/js/layout-Slide.f95cc829.js"><link rel="prefetch" href="/Blog_vuepress/assets/js/page--4687cc40.cd16e28b.js"><link rel="prefetch" href="/Blog_vuepress/assets/js/page-Promise原型方法的实现.14591207.js"><link rel="prefetch" href="/Blog_vuepress/assets/js/page-Promise进行缓存.858d397d.js"><link rel="prefetch" href="/Blog_vuepress/assets/js/page-TODO.42d2d9fa.js"><link rel="prefetch" href="/Blog_vuepress/assets/js/page-axios.d6e54185.js"><link rel="prefetch" href="/Blog_vuepress/assets/js/page-bind.084bcc89.js"><link rel="prefetch" href="/Blog_vuepress/assets/js/page-css基础.a086ed33.js"><link rel="prefetch" href="/Blog_vuepress/assets/js/page-decorator.38a280b2.js"><link rel="prefetch" href="/Blog_vuepress/assets/js/page-html基础.3b373019.js"><link rel="prefetch" href="/Blog_vuepress/assets/js/page-http.558ac34d.js"><link rel="prefetch" href="/Blog_vuepress/assets/js/page-javascript创建对象的几种方式及其优缺点.f4506378.js"><link rel="prefetch" href="/Blog_vuepress/assets/js/page-javascript基础.6eceaece.js"><link rel="prefetch" href="/Blog_vuepress/assets/js/page-new.c64c196d.js"><link rel="prefetch" href="/Blog_vuepress/assets/js/page-problemsets-programmingproblemsets,algorithmproblemsetsandetc.33bf51ae.js"><link rel="prefetch" href="/Blog_vuepress/assets/js/page-programmingproblemsets.fab982e6.js"><link rel="prefetch" href="/Blog_vuepress/assets/js/page-question1.dfb028a8.js"><link rel="prefetch" href="/Blog_vuepress/assets/js/page-this.16d5a681.js"><link rel="prefetch" href="/Blog_vuepress/assets/js/page-token原理.c14d5cda.js"><link rel="prefetch" href="/Blog_vuepress/assets/js/page-typescript函数式编程.54c65e87.js"><link rel="prefetch" href="/Blog_vuepress/assets/js/page-typescript基础.1f5b783d.js"><link rel="prefetch" href="/Blog_vuepress/assets/js/page-vite+vue+ts环境配置.7c114861.js"><link rel="prefetch" href="/Blog_vuepress/assets/js/page-事件循环.6eb6b750.js"><link rel="prefetch" href="/Blog_vuepress/assets/js/page-作用域.b35917d6.js"><link rel="prefetch" href="/Blog_vuepress/assets/js/page-关于.e2b8a1a9.js"><link rel="prefetch" href="/Blog_vuepress/assets/js/page-函数传参方式.f9fc04bd.js"><link rel="prefetch" href="/Blog_vuepress/assets/js/page-分类.c83b5260.js"><link rel="prefetch" href="/Blog_vuepress/assets/js/page-前端基础.e61b00c3.js"><link rel="prefetch" href="/Blog_vuepress/assets/js/page-前端跨域.6e013640.js"><link rel="prefetch" href="/Blog_vuepress/assets/js/page-原型与原型链.58abd104.js"><link rel="prefetch" href="/Blog_vuepress/assets/js/page-变量对象.faef09a7.js"><link rel="prefetch" href="/Blog_vuepress/assets/js/page-基础问题集.c5da138f.js"><link rel="prefetch" href="/Blog_vuepress/assets/js/page-学习心得.5e4a4203.js"><link rel="prefetch" href="/Blog_vuepress/assets/js/page-实现一个call和apply.cacf994a.js"><link rel="prefetch" href="/Blog_vuepress/assets/js/page-封装axios.b6208595.js"><link rel="prefetch" href="/Blog_vuepress/assets/js/page-常用工具封装.7840b09b.js"><link rel="prefetch" href="/Blog_vuepress/assets/js/page-开源项目学习心得.e0ffc100.js"><link rel="prefetch" href="/Blog_vuepress/assets/js/page-执行上下文.c68c8eec.js"><link rel="prefetch" href="/Blog_vuepress/assets/js/page-执行上下文栈.bc7ffb1e.js"><link rel="prefetch" href="/Blog_vuepress/assets/js/page-拷贝.b40257ca.js"><link rel="prefetch" href="/Blog_vuepress/assets/js/page-数组的函数式编程.2f90ced4.js"><link rel="prefetch" href="/Blog_vuepress/assets/js/page-柯里化与偏应用.c055e3e7.js"><link rel="prefetch" href="/Blog_vuepress/assets/js/page-测试文件.1436c167.js"><link rel="prefetch" href="/Blog_vuepress/assets/js/page-环境配置.09445312.js"><link rel="prefetch" href="/Blog_vuepress/assets/js/page-类选择器.2c032236.js"><link rel="prefetch" href="/Blog_vuepress/assets/js/page-系列文章.31bd56b9.js"><link rel="prefetch" href="/Blog_vuepress/assets/js/page-组合与管道.6be0383f.js"><link rel="prefetch" href="/Blog_vuepress/assets/js/page-继承的几种方式及其优缺点.73336955.js"><link rel="prefetch" href="/Blog_vuepress/assets/js/page-网络基础.d4ec8615.js"><link rel="prefetch" href="/Blog_vuepress/assets/js/page-节流.1b33bbc6.js"><link rel="prefetch" href="/Blog_vuepress/assets/js/page-语义化标签.e6f2c25f.js"><link rel="prefetch" href="/Blog_vuepress/assets/js/page-闭包.517cf23b.js"><link rel="prefetch" href="/Blog_vuepress/assets/js/page-闭包与高阶函数.242b65a3.js"><link rel="prefetch" href="/Blog_vuepress/assets/js/page-防抖.ac0c320e.js"><link rel="prefetch" href="/Blog_vuepress/assets/js/page-页面布局.930a7fe1.js"><link rel="prefetch" href="/Blog_vuepress/assets/js/page-项目上线之nginx配置.6cdc6d35.js"><link rel="prefetch" href="/Blog_vuepress/assets/js/page-首页.56fe0ee6.js"><link rel="prefetch" href="/Blog_vuepress/assets/js/page-高阶函数.392177ea.js"><link rel="prefetch" href="/Blog_vuepress/assets/js/vendors~flowchart.fcfb21eb.js"><link rel="prefetch" href="/Blog_vuepress/assets/js/vendors~photo-swipe.8825145f.js"><link rel="prefetch" href="/Blog_vuepress/assets/js/vendors~reveal.ac11e710.js">
    <link rel="stylesheet" href="/Blog_vuepress/assets/css/0.styles.1e0213a7.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container has-navbar has-sidebar has-anchor"><header class="navbar"><button class="sidebar-button"><span class="icon"></span></button> <a href="/Blog_vuepress/" class="home-link router-link-active"><img src="/Blog_vuepress/assets/img/logo.png" alt="Ru Shui" class="logo"> <!----> <span class="site-name can-hide">Ru Shui</span></a> <div class="links"><button class="color-button"><svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="skin-icon"><path d="M224 800c0 9.6 3.2 44.8 6.4 54.4 6.4 48-48 76.8-48 76.8s80 41.6 147.2 0 134.4-134.4
        38.4-195.2c-22.4-12.8-41.6-19.2-57.6-19.2C259.2 716.8 227.2 761.6 224 800zM560 675.2l-32
        51.2c-51.2 51.2-83.2 32-83.2 32 25.6 67.2 0 112-12.8 128 25.6 6.4 51.2 9.6 80 9.6 54.4 0
        102.4-9.6 150.4-32l0 0c3.2 0 3.2-3.2 3.2-3.2 22.4-16 12.8-35.2
        6.4-44.8-9.6-12.8-12.8-25.6-12.8-41.6 0-54.4 60.8-99.2 137.6-99.2 6.4 0 12.8 0 22.4
        0 12.8 0 38.4 9.6 48-25.6 0-3.2 0-3.2 3.2-6.4 0-3.2 3.2-6.4 3.2-6.4 6.4-16 6.4-16 6.4-19.2
        9.6-35.2 16-73.6 16-115.2 0-105.6-41.6-198.4-108.8-268.8C704 396.8 560 675.2 560 675.2zM224
        419.2c0-28.8 22.4-51.2 51.2-51.2 28.8 0 51.2 22.4 51.2 51.2 0 28.8-22.4 51.2-51.2 51.2C246.4
        470.4 224 448 224 419.2zM320 284.8c0-22.4 19.2-41.6 41.6-41.6 22.4 0 41.6 19.2 41.6 41.6 0
        22.4-19.2 41.6-41.6 41.6C339.2 326.4 320 307.2 320 284.8zM457.6 208c0-12.8 12.8-25.6 25.6-25.6
        12.8 0 25.6 12.8 25.6 25.6 0 12.8-12.8 25.6-25.6 25.6C470.4 233.6 457.6 220.8 457.6 208zM128
        505.6C128 592 153.6 672 201.6 736c28.8-60.8 112-60.8 124.8-60.8-16-51.2 16-99.2
        16-99.2l316.8-422.4c-48-19.2-99.2-32-150.4-32C297.6 118.4 128 291.2 128 505.6zM764.8
        86.4c-22.4 19.2-390.4 518.4-390.4 518.4-22.4 28.8-12.8 76.8 22.4 99.2l9.6 6.4c35.2 22.4
        80 12.8 99.2-25.6 0 0 6.4-12.8 9.6-19.2 54.4-105.6 275.2-524.8 288-553.6
        6.4-19.2-3.2-32-19.2-32C777.6 76.8 771.2 80 764.8 86.4z"></path></svg> <div class="color-picker-menu" style="display:none;"><div class="theme-options"><ul class="themecolor-select"><label for="themecolor-select">Theme Color:</label> <li><a href="#" class="default-theme"></a></li> </ul> <div class="darkmode-toggle"><label for="darkmode-toggle" class="desc">Theme Mode:</label> <div class="darkmode-switch"><div class="switch"><input id="switch" type="checkbox" checked="checked" class="switch-input"> <label for="switch" class="label"><span class="label-content"></span></label></div></div> <!----></div></div></div></button> <div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/Blog_vuepress/" class="nav-link router-link-active"><!---->
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="分类" class="dropdown-title"><span class="title"><!---->
        分类
      </span> <span class="arrow down"></span></button> <ul class="nav-dropdown"><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>前端基础</span></h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/Blog_vuepress/cate/fe_base/html_base/" class="nav-link"><!---->
  html
</a></li><li class="dropdown-subitem"><a href="/Blog_vuepress/cate/fe_base/css_base/" class="nav-link"><!---->
  css
</a></li><li class="dropdown-subitem"><a href="/Blog_vuepress/cate/fe_base/javascript_base/" class="nav-link router-link-active active"><!---->
  javascript
</a></li><li class="dropdown-subitem"><a href="/Blog_vuepress/cate/fe_base/typescript_base/" class="nav-link"><!---->
  typescript
</a></li><li class="dropdown-subitem"><a href="/Blog_vuepress/cate/fe_base/network_base/" class="nav-link"><!---->
  network
</a></li></ul></li><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>系列文章</span></h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/Blog_vuepress/cate/series/fp_ts/" class="nav-link"><!---->
  函数式编程
</a></li><li class="dropdown-subitem"><a href="/Blog_vuepress/cate/series/encapsulation/" class="nav-link"><!---->
  常用工具封装
</a></li></ul></li><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>学习心得</span></h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/Blog_vuepress/cate/learning-comprehension/open-source/" class="nav-link"><!---->
  开源项目
</a></li></ul></li><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>问题集</span></h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/Blog_vuepress/cate/problem_sets/programming/" class="nav-link"><!---->
  编程问题集
</a></li><li class="dropdown-subitem"><a href="/Blog_vuepress/cate/problem_sets/basic/" class="nav-link"><!---->
  基础问题集
</a></li></ul></li><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>环境配置</span></h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/Blog_vuepress/cate/env_config/" class="nav-link"><!---->
  项目环境配置
</a></li></ul></li></ul></div></div><div class="nav-item"><a href="/Blog_vuepress/tag/" class="nav-link"><!---->
  标签
</a></div><div class="nav-item"><a href="/Blog_vuepress/timeline/" class="nav-link"><!---->
  归档
</a></div><div class="nav-item"><a href="/Blog_vuepress/about/" class="nav-link"><!---->
  关于
</a></div></nav> <!----> <!----></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><div vocab="https://schema.org/" typeof="Person" class="blogger-info"><div data-balloon-pos="" class="blogger"><img property="image" alt="Blogger Avatar" src="/Blog_vuepress/assets/img/logo.png" class="avatar"> <div property="name" class="name">ru shui</div> <!----></div> <div class="num-wrapper"><div><div class="num">39</div> <div>Articles</div></div> <div><div class="num">7</div> <div>Category</div></div> <div><div class="num">58</div> <div>Tags</div></div> <div><div class="num">39</div> <div>Timeline</div></div></div> <!----></div> <hr>  <nav class="sidebar-nav-links"><div class="nav-item"><a href="/Blog_vuepress/" class="nav-link router-link-active"><!---->
  首页
</a></div><div class="nav-item"><div class="mobile-dropdown-wrapper"><button type="button" aria-label="分类" class="dropdown-title"><span class="title"><!---->
      分类
    </span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>前端基础</span></h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/Blog_vuepress/cate/fe_base/html_base/" class="nav-link"><!---->
  html
</a></li><li class="dropdown-subitem"><a href="/Blog_vuepress/cate/fe_base/css_base/" class="nav-link"><!---->
  css
</a></li><li class="dropdown-subitem"><a href="/Blog_vuepress/cate/fe_base/javascript_base/" class="nav-link router-link-active active"><!---->
  javascript
</a></li><li class="dropdown-subitem"><a href="/Blog_vuepress/cate/fe_base/typescript_base/" class="nav-link"><!---->
  typescript
</a></li><li class="dropdown-subitem"><a href="/Blog_vuepress/cate/fe_base/network_base/" class="nav-link"><!---->
  network
</a></li></ul></li><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>系列文章</span></h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/Blog_vuepress/cate/series/fp_ts/" class="nav-link"><!---->
  函数式编程
</a></li><li class="dropdown-subitem"><a href="/Blog_vuepress/cate/series/encapsulation/" class="nav-link"><!---->
  常用工具封装
</a></li></ul></li><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>学习心得</span></h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/Blog_vuepress/cate/learning-comprehension/open-source/" class="nav-link"><!---->
  开源项目
</a></li></ul></li><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>问题集</span></h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/Blog_vuepress/cate/problem_sets/programming/" class="nav-link"><!---->
  编程问题集
</a></li><li class="dropdown-subitem"><a href="/Blog_vuepress/cate/problem_sets/basic/" class="nav-link"><!---->
  基础问题集
</a></li></ul></li><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>环境配置</span></h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/Blog_vuepress/cate/env_config/" class="nav-link"><!---->
  项目环境配置
</a></li></ul></li></ul></div></div><div class="nav-item"><a href="/Blog_vuepress/tag/" class="nav-link"><!---->
  标签
</a></div><div class="nav-item"><a href="/Blog_vuepress/timeline/" class="nav-link"><!---->
  归档
</a></div><div class="nav-item"><a href="/Blog_vuepress/about/" class="nav-link"><!---->
  关于
</a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/Blog_vuepress/cate/fe_base/javascript_base/1_1debounce/" class="sidebar-link">防抖</a></li><li><a href="/Blog_vuepress/cate/fe_base/javascript_base/1_2throttle/" class="sidebar-link">节流</a></li><li><a href="/Blog_vuepress/cate/fe_base/javascript_base/2_1prototype/" class="sidebar-link">原型与原型链</a></li><li><a href="/Blog_vuepress/cate/fe_base/javascript_base/2_2scope/" class="sidebar-link">作用域</a></li><li><a href="/Blog_vuepress/cate/fe_base/javascript_base/2_3execute_context_stack/" class="sidebar-link">执行上下文栈</a></li><li><a href="/Blog_vuepress/cate/fe_base/javascript_base/2_4variable_object/" class="sidebar-link">变量对象</a></li><li><a href="/Blog_vuepress/cate/fe_base/javascript_base/2_5context/" class="sidebar-link">执行上下文</a></li><li><a href="/Blog_vuepress/cate/fe_base/javascript_base/3_1promise/" class="sidebar-link">Promise原型方法的实现</a></li><li><a href="/Blog_vuepress/cate/fe_base/javascript_base/3_2promise_cache/" class="sidebar-link">Promise进行缓存</a></li><li><a href="/Blog_vuepress/cate/fe_base/javascript_base/4_1.call_apply/" class="sidebar-link">实现一个call和apply</a></li><li><a href="/Blog_vuepress/cate/fe_base/javascript_base/4_2_bind/" class="sidebar-link">bind</a></li><li><a href="/Blog_vuepress/cate/fe_base/javascript_base/4_3_new/" class="sidebar-link">new</a></li><li><a href="/Blog_vuepress/cate/fe_base/javascript_base/copy/" class="sidebar-link">拷贝</a></li><li><a href="/Blog_vuepress/cate/fe_base/javascript_base/create_object/" class="sidebar-link">javascript创建对象的几种方式及其优缺点</a></li><li><a href="/Blog_vuepress/cate/fe_base/javascript_base/event_loop/" class="sidebar-link">事件循环</a></li><li><a href="/Blog_vuepress/cate/fe_base/javascript_base/high_performance/" aria-current="page" class="active sidebar-link">高性能javascript</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Blog_vuepress/cate/fe_base/javascript_base/high_performance/#写在前面" class="sidebar-link">写在前面</a></li><li class="sidebar-sub-header"><a href="/Blog_vuepress/cate/fe_base/javascript_base/high_performance/#加载与执行" class="sidebar-link">加载与执行</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Blog_vuepress/cate/fe_base/javascript_base/high_performance/#脚本的位置" class="sidebar-link heading3">脚本的位置</a></li><li class="sidebar-sub-header"><a href="/Blog_vuepress/cate/fe_base/javascript_base/high_performance/#非阻塞script" class="sidebar-link heading3">非阻塞script</a></li></ul></li><li class="sidebar-sub-header"><a href="/Blog_vuepress/cate/fe_base/javascript_base/high_performance/#数据存储" class="sidebar-link">数据存储</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Blog_vuepress/cate/fe_base/javascript_base/high_performance/#管理作用域" class="sidebar-link heading3">管理作用域</a></li><li class="sidebar-sub-header"><a href="/Blog_vuepress/cate/fe_base/javascript_base/high_performance/#对象成员" class="sidebar-link heading3">对象成员</a></li></ul></li><li class="sidebar-sub-header"><a href="/Blog_vuepress/cate/fe_base/javascript_base/high_performance/#dom-编程" class="sidebar-link">DOM 编程</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Blog_vuepress/cate/fe_base/javascript_base/high_performance/#dom-的访问与修改" class="sidebar-link heading3">DOM 的访问与修改</a></li><li class="sidebar-sub-header"><a href="/Blog_vuepress/cate/fe_base/javascript_base/high_performance/#网页性能" class="sidebar-link heading3">网页性能</a></li><li class="sidebar-sub-header"><a href="/Blog_vuepress/cate/fe_base/javascript_base/high_performance/#事件委托-2" class="sidebar-link heading3">事件委托</a></li></ul></li><li class="sidebar-sub-header"><a href="/Blog_vuepress/cate/fe_base/javascript_base/high_performance/#算法与流程控制" class="sidebar-link">算法与流程控制</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Blog_vuepress/cate/fe_base/javascript_base/high_performance/#循环" class="sidebar-link heading3">循环</a></li><li class="sidebar-sub-header"><a href="/Blog_vuepress/cate/fe_base/javascript_base/high_performance/#递归" class="sidebar-link heading3">递归</a></li><li class="sidebar-sub-header"><a href="/Blog_vuepress/cate/fe_base/javascript_base/high_performance/#条件语句" class="sidebar-link heading3">条件语句</a></li></ul></li><li class="sidebar-sub-header"><a href="/Blog_vuepress/cate/fe_base/javascript_base/high_performance/#字符串与正则" class="sidebar-link">字符串与正则</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Blog_vuepress/cate/fe_base/javascript_base/high_performance/#字符串" class="sidebar-link heading3">字符串</a></li><li class="sidebar-sub-header"><a href="/Blog_vuepress/cate/fe_base/javascript_base/high_performance/#正则优化" class="sidebar-link heading3">正则优化</a></li></ul></li><li class="sidebar-sub-header"><a href="/Blog_vuepress/cate/fe_base/javascript_base/high_performance/#快速响应的用户界面" class="sidebar-link">快速响应的用户界面</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Blog_vuepress/cate/fe_base/javascript_base/high_performance/#浏览器-ui-线程" class="sidebar-link heading3">浏览器 UI 线程</a></li><li class="sidebar-sub-header"><a href="/Blog_vuepress/cate/fe_base/javascript_base/high_performance/#定时器" class="sidebar-link heading3">定时器</a></li><li class="sidebar-sub-header"><a href="/Blog_vuepress/cate/fe_base/javascript_base/high_performance/#web-workers" class="sidebar-link heading3">web workers</a></li></ul></li><li class="sidebar-sub-header"><a href="/Blog_vuepress/cate/fe_base/javascript_base/high_performance/#ajax" class="sidebar-link">Ajax</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Blog_vuepress/cate/fe_base/javascript_base/high_performance/#数据传输" class="sidebar-link heading3">数据传输</a></li><li class="sidebar-sub-header"><a href="/Blog_vuepress/cate/fe_base/javascript_base/high_performance/#数据格式" class="sidebar-link heading3">数据格式</a></li><li class="sidebar-sub-header"><a href="/Blog_vuepress/cate/fe_base/javascript_base/high_performance/#ajax-性能指南" class="sidebar-link heading3">Ajax 性能指南</a></li></ul></li></ul></li><li><a href="/Blog_vuepress/cate/fe_base/javascript_base/inherit/" class="sidebar-link">继承的几种方式及其优缺点</a></li><li><a href="/Blog_vuepress/cate/fe_base/javascript_base/parameter/" class="sidebar-link">函数传参方式</a></li></ul> </aside> <main class="page"><nav class="breadcrumb"><ol vocab="https://schema.org/" typeof="BreadcrumbList"><li property="itemListElement" typeof="ListItem"><a href="/Blog_vuepress/cate/" property="item" typeof="WebPage" class="router-link-active"><!----> <span property="name">分类</span></a> <meta property="position" content="1"></li><li property="itemListElement" typeof="ListItem"><a href="/Blog_vuepress/cate/fe_base/" property="item" typeof="WebPage" class="router-link-active"><!----> <span property="name">前端基础</span></a> <meta property="position" content="2"></li><li property="itemListElement" typeof="ListItem"><a href="/Blog_vuepress/cate/fe_base/javascript_base/" property="item" typeof="WebPage" class="router-link-active"><!----> <span property="name">javascript基础</span></a> <meta property="position" content="3"></li><li property="itemListElement" typeof="ListItem" class="is-active"><a href="/Blog_vuepress/cate/fe_base/javascript_base/high_performance/" aria-current="page" property="item" typeof="WebPage" class="router-link-exact-active router-link-active"><!----> <span property="name">高性能javascript</span></a> <meta property="position" content="4"></li></ol></nav>  <div vocab="https://schema.org/" typeof="Article" class="page-title"><h1><!----> <span property="headline">高性能javascript</span></h1> <div class="page-info"><!----> <span aria-label="Author🖊" data-balloon-pos="down"><svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="icon author-icon"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z" fill="currentColor"></path></svg> <span property="author">ru shui</span></span><span aria-label="Page views🔢" data-balloon-pos="down" class="visitor-info"><svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="icon eye-icon"><path d="M992 512.096c0-5.76-.992-10.592-1.28-11.136-.192-2.88-1.152-8.064-2.08-10.816-.256-.672-.544-1.376-.832-2.08-.48-1.568-1.024-3.104-1.6-4.32C897.664 290.112 707.104 160 512 160c-195.072 0-385.632 130.016-473.76 322.592-1.056 2.112-1.792 4.096-2.272 5.856a55.512 55.512 0 0 0-.64 1.6c-1.76 5.088-1.792 8.64-1.632 7.744-.832 3.744-1.568 11.168-1.568 11.168-.224 2.272-.224 4.032.032 6.304 0 0 .736 6.464 1.088 7.808.128 1.824.576 4.512 1.12 6.976h-.032c.448 2.08 1.12 4.096 1.984 6.08.48 1.536.992 2.976 1.472 4.032C126.432 733.856 316.992 864 512 864c195.136 0 385.696-130.048 473.216-321.696 1.376-2.496 2.24-4.832 2.848-6.912.256-.608.48-1.184.672-1.728 1.536-4.48 1.856-8.32 1.728-8.32l-.032.032c.608-3.104 1.568-7.744 1.568-13.28zM512 672c-88.224 0-160-71.776-160-160s71.776-160 160-160 160 71.776 160 160-71.776 160-160 160z" fill="currentColor"></path></svg> <span id="/Blog_vuepress/cate/fe_base/javascript_base/high_performance/" data-flag-title="高性能javascript" class="leancloud_visitors"><span class="leancloud-visitors-count">...</span></span></span><span aria-label="Writing Date📅" data-balloon-pos="down" class="time-info"><svg viewBox="0 0 1030 1024" xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 0 1-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 0 1-33.473-33.473V143.657H180.6A134.314 134.314 0 0 0 46.66 277.595v535.756A134.314 134.314 0 0 0 180.6 947.289h669.74a134.36 134.36 0 0 0 133.94-133.938V277.595a134.314 134.314 0 0 0-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 0 1-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 0 1-33.472 33.473z" fill="currentColor"></path></svg> <span property="datePublished">2021-04-06 </span></span><span role="navigation" aria-label="Category🌈" data-balloon-pos="down" class="category-info enable"><svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="icon category-icon"><path d="M148.41 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H148.41c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.311-40.31zm-.854 446.486H429.73c22.263 0 40.311 18.048 40.311 40.31v282.176c0 22.263-18.048 40.312-40.31 40.312H147.555c-22.263 0-40.311-18.049-40.311-40.312V593.79c0-22.263 18.048-40.311 40.31-40.311zm446.371-446.486h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H593.927c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.31-40.31zm136.293 813.51H623.926c-40.925 0-74.22-33.388-74.22-74.425V623.992c0-41.038 33.387-74.424 74.425-74.424h222.085c41.038 0 74.424 33.226 74.424 74.067v114.233c0 10.244-8.304 18.548-18.547 18.548s-18.548-8.304-18.548-18.548V623.635c0-20.388-16.746-36.974-37.33-36.974H624.13c-20.585 0-37.331 16.747-37.331 37.33v222.086c0 20.585 16.654 37.331 37.126 37.331H730.22c10.243 0 18.547 8.304 18.547 18.547 0 10.244-8.304 18.547-18.547 18.547z" fill="currentColor"></path></svg> <span property="articleSection">前端基础</span></span><span aria-label="Tags🏷" data-balloon-pos="down"><svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="icon tag-icon"><path d="M939.902 458.563 910.17 144.567c-1.507-16.272-14.465-29.13-30.737-30.737L565.438 84.098h-.402c-3.215 0-5.726 1.005-7.634 2.913l-470.39 470.39a10.004 10.004 0 0 0 0 14.164l365.423 365.424c1.909 1.908 4.42 2.913 7.132 2.913s5.223-1.005 7.132-2.913l470.39-470.39c2.01-2.11 3.014-5.023 2.813-8.036zm-240.067-72.121c-35.458 0-64.286-28.828-64.286-64.286s28.828-64.285 64.286-64.285 64.286 28.828 64.286 64.285-28.829 64.286-64.286 64.286z" fill="currentColor"></path></svg> <ul class="tags-wrapper"><li class="tag clickable tag0"><span role="navigation">Frontend</span></li><li class="tag clickable tag1"><span role="navigation">Javascript</span></li><li class="tag clickable tag2"><span role="navigation">High performance</span></li> <meta property="keywords" content="Frontend,Javascript,High performance"></ul></span><span aria-label="Reading Time⌛" data-balloon-pos="down" class="reading-time-info"><svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="icon timer-icon"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z" fill="currentColor"></path></svg> <span>About 12 min</span> <meta property="timeRequired" content="PT12M"></span></div> <!----> <hr></div> <div class="anchor-place-holder"><aside id="anchor"><div class="anchor-wrapper"><ul class="anchor-list"><li class="anchor"><a href="/Blog_vuepress/cate/fe_base/javascript_base/high_performance/#写在前面" class="anchor-link heading2"><div>写在前面</div></a></li><li class="anchor"><a href="/Blog_vuepress/cate/fe_base/javascript_base/high_performance/#加载与执行" class="anchor-link heading2"><div>加载与执行</div></a></li><li class="anchor"><a href="/Blog_vuepress/cate/fe_base/javascript_base/high_performance/#脚本的位置" class="anchor-link heading3"><div>脚本的位置</div></a></li><li class="anchor"><a href="/Blog_vuepress/cate/fe_base/javascript_base/high_performance/#非阻塞script" class="anchor-link heading3"><div>非阻塞script</div></a></li><li class="anchor"><a href="/Blog_vuepress/cate/fe_base/javascript_base/high_performance/#数据存储" class="anchor-link heading2"><div>数据存储</div></a></li><li class="anchor"><a href="/Blog_vuepress/cate/fe_base/javascript_base/high_performance/#管理作用域" class="anchor-link heading3"><div>管理作用域</div></a></li><li class="anchor"><a href="/Blog_vuepress/cate/fe_base/javascript_base/high_performance/#对象成员" class="anchor-link heading3"><div>对象成员</div></a></li><li class="anchor"><a href="/Blog_vuepress/cate/fe_base/javascript_base/high_performance/#dom-编程" class="anchor-link heading2"><div>DOM 编程</div></a></li><li class="anchor"><a href="/Blog_vuepress/cate/fe_base/javascript_base/high_performance/#dom-的访问与修改" class="anchor-link heading3"><div>DOM 的访问与修改</div></a></li><li class="anchor"><a href="/Blog_vuepress/cate/fe_base/javascript_base/high_performance/#网页性能" class="anchor-link heading3"><div>网页性能</div></a></li><li class="anchor"><a href="/Blog_vuepress/cate/fe_base/javascript_base/high_performance/#事件委托-2" class="anchor-link heading3"><div>事件委托</div></a></li><li class="anchor"><a href="/Blog_vuepress/cate/fe_base/javascript_base/high_performance/#算法与流程控制" class="anchor-link heading2"><div>算法与流程控制</div></a></li><li class="anchor"><a href="/Blog_vuepress/cate/fe_base/javascript_base/high_performance/#循环" class="anchor-link heading3"><div>循环</div></a></li><li class="anchor"><a href="/Blog_vuepress/cate/fe_base/javascript_base/high_performance/#递归" class="anchor-link heading3"><div>递归</div></a></li><li class="anchor"><a href="/Blog_vuepress/cate/fe_base/javascript_base/high_performance/#条件语句" class="anchor-link heading3"><div>条件语句</div></a></li><li class="anchor"><a href="/Blog_vuepress/cate/fe_base/javascript_base/high_performance/#字符串与正则" class="anchor-link heading2"><div>字符串与正则</div></a></li><li class="anchor"><a href="/Blog_vuepress/cate/fe_base/javascript_base/high_performance/#字符串" class="anchor-link heading3"><div>字符串</div></a></li><li class="anchor"><a href="/Blog_vuepress/cate/fe_base/javascript_base/high_performance/#正则优化" class="anchor-link heading3"><div>正则优化</div></a></li><li class="anchor"><a href="/Blog_vuepress/cate/fe_base/javascript_base/high_performance/#快速响应的用户界面" class="anchor-link heading2"><div>快速响应的用户界面</div></a></li><li class="anchor"><a href="/Blog_vuepress/cate/fe_base/javascript_base/high_performance/#浏览器-ui-线程" class="anchor-link heading3"><div>浏览器 UI 线程</div></a></li><li class="anchor"><a href="/Blog_vuepress/cate/fe_base/javascript_base/high_performance/#定时器" class="anchor-link heading3"><div>定时器</div></a></li><li class="anchor"><a href="/Blog_vuepress/cate/fe_base/javascript_base/high_performance/#web-workers" class="anchor-link heading3"><div>web workers</div></a></li><li class="anchor"><a href="/Blog_vuepress/cate/fe_base/javascript_base/high_performance/#ajax" class="anchor-link heading2"><div>Ajax</div></a></li><li class="anchor"><a href="/Blog_vuepress/cate/fe_base/javascript_base/high_performance/#数据传输" class="anchor-link heading3"><div>数据传输</div></a></li><li class="anchor"><a href="/Blog_vuepress/cate/fe_base/javascript_base/high_performance/#数据格式" class="anchor-link heading3"><div>数据格式</div></a></li><li class="anchor"><a href="/Blog_vuepress/cate/fe_base/javascript_base/high_performance/#ajax-性能指南" class="anchor-link heading3"><div>Ajax 性能指南</div></a></li></ul></div></aside></div> <div class="theme-default-content content__default"><h2 id="写在前面"><a href="#写在前面" class="header-anchor">#</a> 写在前面</h2> <p>本篇文章是我在阅读《高性能 javascript》后所写的笔记，只会记录书本中一些比较重要的知识点，所以笔记可能没有那么全面。但是，对于某些重要的概念，通过阅读其他博客，我也对其进行拓展。比如：网页性能管理和事件委托等。</p> <h2 id="加载与执行"><a href="#加载与执行" class="header-anchor">#</a> 加载与执行</h2> <h3 id="脚本的位置"><a href="#脚本的位置" class="header-anchor">#</a> 脚本的位置</h3> <p>1.浏览器引擎在遇到<code>&lt;script&gt;</code>标签会执行 js 代码。这会导致页面渲染阻塞，直到 js 代码执行完毕。
所以，一般而言，会将<code>script</code>标签放置在<code>&lt;/body&gt;</code>闭合标签之前。除了不会影响浏览器渲染页面之外，还有就是 js 在操作 DOM 元素必须等到 DOM 加载完成才能操作对应的元素，将<code>&lt;script&gt;</code>标签放在<code>&lt;/body&gt;</code>前可以确保 DOM 元素加载完成。</p> <h3 id="非阻塞script"><a href="#非阻塞script" class="header-anchor">#</a> 非阻塞<code>script</code></h3> <ul><li><code>defer</code>：异步加载。当 DOM 渲染完成后才执行 js 代码</li> <li><code>async</code>：异步加载。加载完成立即执行。</li> <li>使用<code>XMLHttpRequest</code>请求外部的 js 代码，然后创建<code>script</code>标签，将请求到的代码写到<code>script</code>标签中，实现动态加载。</li></ul> <h2 id="数据存储"><a href="#数据存储" class="header-anchor">#</a> 数据存储</h2> <h3 id="管理作用域"><a href="#管理作用域" class="header-anchor">#</a> 管理作用域</h3> <h4 id="不同类型的变量获取速度不同。"><a href="#不同类型的变量获取速度不同。" class="header-anchor">#</a> 不同类型的变量获取速度不同。</h4> <p>一般而言：本地变量，字面量 &gt; 数组元素，对象成员。所以如果需要多次使用同一个对象/对象成员/数组/数组元素，可以将其用局部变量保存起来，提高访问速度。</p> <h4 id="改变作用域链"><a href="#改变作用域链" class="header-anchor">#</a> 改变作用域链</h4> <p>使用 try/catch 会修改作用域链：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">try</span> <span class="token punctuation">{</span>
<span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 作用域链在这里发生改变</span>
  <span class="token comment">// err对应的作用域链太长</span>
  <span class="token function">handleErr</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>由于 err 对应的作用域链太长，如果对异常的处理逻辑过长，可以使用一个函数对异常进行处理。</p> <h4 id="闭包、作用域和内存"><a href="#闭包、作用域和内存" class="header-anchor">#</a> 闭包、作用域和内存</h4> <p>使用闭包延长作用域的同时，会导致作用域链太长，影响访问变量的速度。
解决办法之一就是可以把闭包用到的变量用一个局部变量保存下来。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">/* object_member1.js */</span>

<span class="token keyword">function</span> <span class="token function">curry</span><span class="token punctuation">(</span><span class="token parameter">x</span><span class="token punctuation">)</span><span class="token operator">:</span> any <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">y</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> _x <span class="token operator">=</span> x
    <span class="token comment">// statements...</span>
    <span class="token keyword">return</span> _x <span class="token operator">+</span> y
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h3 id="对象成员"><a href="#对象成员" class="header-anchor">#</a> 对象成员</h3> <p>在 js 中，对象成员包括成员属性和成员方法。在前面我们已经了解过，访问对象成员的速度要比访问局部变量和字面量慢，这涉及到 js 中对象的本质。下面我们将一一道出。</p> <h4 id="原型"><a href="#原型" class="header-anchor">#</a> 原型</h4> <p>与其他编程语言不同，js 中的对象是基于原型实现的。对象通过一个内部属性(<strong>proto</strong>绑定到它的原型。一旦我们创建一个对象（例如 Array 或者 Object）就会自动拥有一个 Object 实例作为原型。
（大部分浏览器已经支持<code>__proto__</code>访问对象原型，但是比较正式的用法是<code>Object.getPrototypeOf(obj)</code>）
因此，对象可以有两种成员类型：实例成员（也称 own property）和原型成员。实例成员直接存放在对象实例中，原型成员则是成对象原型链继承下来的。
（实例成员相当于其他语言中，类属性，而原型成员相当于父类属性）
来看下面的一个例子：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">/* object_member2.js*/</span>

<span class="token keyword">const</span> book <span class="token operator">=</span> <span class="token punctuation">{</span>
  title<span class="token operator">:</span> <span class="token string">'high performance javascript'</span><span class="token punctuation">,</span>
  publisher<span class="token operator">:</span> <span class="token string">'Yahoo!!!!'</span>
<span class="token punctuation">}</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>book<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">// [object Object]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>我们创建一个<code>book</code>对象，其中只包含两个成员属性<code>title</code>和<code>publisher</code>，我们并没有声明<code>toString</code>方法，但是使用打印输出时却可以正常访问，这是因为当<code>book.toString()</code>调用时，会先从<code>book</code>对象的成员属性开始查找，如果还没找到，就会到<code>book</code>的原型属性查找，在 js 中所有的对象默认会继承至<code>Object</code>，而<code>Object</code>中含有<code>toString</code>方法，于是我们使用<code>book.toString()</code>并不会报错。来看下面的例子：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">/* object_member3.js */</span>

<span class="token keyword">const</span> obj <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span>
<span class="token comment">// null</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>Object<span class="token punctuation">.</span><span class="token function">getPrototypeOf</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">// undefined</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj<span class="token punctuation">.</span>toString<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>我们使用<code>Object.create()</code>它会将传入的对象作为新对象的原型，这里我们使用了<code>null</code>，这样新创建出来的对象就不具备有原型属性。这样可以节省一些不必要的开支。</p> <p>如果需要判断某个属性是否为实例属性，或者获取对象的实例属性可以通过下面的方式获取：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">/* object_member4.js */</span>

<span class="token keyword">const</span> book <span class="token operator">=</span> <span class="token punctuation">{</span>
  title<span class="token operator">:</span> <span class="token string">'high performance javascript'</span><span class="token punctuation">,</span>
  publisher<span class="token operator">:</span> <span class="token string">'yahoo'</span>
<span class="token punctuation">}</span>

<span class="token comment">// true</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>book<span class="token punctuation">.</span><span class="token function">hasOwnProperty</span><span class="token punctuation">(</span><span class="token string">'title'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">// false</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>book<span class="token punctuation">.</span><span class="token function">hasOwnProperty</span><span class="token punctuation">(</span><span class="token string">'toString'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">// [ 'title', 'publisher' ]</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>Object<span class="token punctuation">.</span><span class="token function">getOwnPropertyNames</span><span class="token punctuation">(</span>book<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>如果需要判断某个属性是否存在可以使用如下方式：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// true</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'title'</span> <span class="token keyword">in</span> book<span class="token punctuation">)</span>
<span class="token comment">// true</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>Reflect<span class="token punctuation">.</span><span class="token function">has</span><span class="token punctuation">(</span>book<span class="token punctuation">,</span> <span class="token string">'toString'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><div class="custom-block tip"><p class="custom-block-title">小技巧</p> <p>如果我们不需要<code>Object</code>的原型方法时，我们可以通过<code>Object.create(null)</code>创建对象。
如果我们不需要遍历对象的原型时，我们应该使用<code>for (const key of obj.keys())</code>进行遍历，这样的效率会高一些。</p></div> <h4 id="原型链"><a href="#原型链" class="header-anchor">#</a> 原型链</h4> <p>对象的原型决定了实例的类型。默认情况所有的对象都继承自<code>Object</code>，当然我们也可以定义构造函数来创建另一种原型的原型：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">/* object_member5.js */</span>

<span class="token keyword">function</span> <span class="token function">Book</span><span class="token punctuation">(</span><span class="token parameter">title<span class="token punctuation">,</span> publisher</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>title <span class="token operator">=</span> title
  title<span class="token punctuation">.</span>publisher <span class="token operator">=</span> publisher
<span class="token punctuation">}</span>

<span class="token class-name">Book</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">sayTitle</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>title<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> book1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Book</span><span class="token punctuation">(</span><span class="token string">'book1'</span><span class="token punctuation">,</span> <span class="token string">'publisher1'</span><span class="token punctuation">)</span>
<span class="token comment">// true</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>book1 <span class="token keyword">instanceof</span> <span class="token class-name">Book</span><span class="token punctuation">)</span>
<span class="token comment">// true</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>book1 <span class="token keyword">instanceof</span> <span class="token class-name">Object</span><span class="token punctuation">)</span>

<span class="token comment">// book1</span>
book1<span class="token punctuation">.</span><span class="token function">sayTitle</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">// [object Object]</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>book1<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><p>对应的原型链为：
<img src="/Blog_vuepress/assets/img/2021-04-08-09-36-14.f9c09c68.png" alt=""></p> <p>其中<code>book1.toString</code>继承自<code>Object</code>，在搜索<code>book1.toString</code>的过程中，随着原型链越深，访问速度随着变慢。所以，可以通过局部变量先进行缓存。</p> <div class="custom-block danger"><p class="custom-block-title">注意事项</p> <p>对于对象的成员方法，使用局部变量缓存可能会导致内部的<code>this</code>指向发生改变。</p></div> <h2 id="dom-编程"><a href="#dom-编程" class="header-anchor">#</a> DOM 编程</h2> <p>文档对象模型(DOM)是独立于编程语言存在的。在浏览器中的接口是通过 js 实现的。由于两者是相互独立的，这就意味着通过 js 访问 DOM 元素天生就是慢，我们可以把 js 和 DOM 想象为两个岛屿，它们之间通过收费桥梁连接，js 每次访问 DOM 都需要经过这座桥梁，每次都需要交纳过桥费，于是访问 DOM 的次数越多，费用越高。因此，应该尽可能地减少对 DOM 的访问。</p> <h3 id="dom-的访问与修改"><a href="#dom-的访问与修改" class="header-anchor">#</a> DOM 的访问与修改</h3> <p>考虑下面例子：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">innerHtmlLoop</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">1000</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'div'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>innerHTML <span class="token operator">+=</span> <span class="token string">'a'</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>虽然我们不会直接写成这种代码，但是通过这个例子我们可以来分析性能。这里每一次循环都修改 DOM 元素的<code>innerHTML</code>，这样做的开销极大，一种优化方案为：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">innerHtmlLoop</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> content <span class="token operator">=</span> <span class="token string">''</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">1000</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    content <span class="token operator">+=</span> <span class="token string">'a'</span>
  <span class="token punctuation">}</span>
  document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'div'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> content
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>这样我们就把多次访问 DOM 元素转换成 1 此访问，从而减少不必要的开销。</p> <h3 id="网页性能"><a href="#网页性能" class="header-anchor">#</a> 网页性能</h3> <h4 id="网页的生成过程"><a href="#网页的生成过程" class="header-anchor">#</a> 网页的生成过程</h4> <p>在讲重绘和重排之前，让我们先了解一下网页的生成过程。
网页的生成过程可以大致分为如下 5 个步骤：</p> <ol><li>HTML 代码转化为 DOM</li> <li>CSS 代码转化为 CSSOM（css Object Model）</li> <li>结合 DOM 和 CSSOM 生成一颗渲染树（生成结点信息）</li> <li>生成布局（layout），即将所有的渲染树的所有结点进行平面合成</li> <li>将布局绘制（paint）在屏幕上。</li></ol> <p><img src="/Blog_vuepress/assets/img/bg2015091501.6bcb165e.png" alt="page generation">
从 1 到 3 的执行速度非常快，生成布局和布局绘制称之为渲染过程，这个过程是非常耗时的。
<img src="/Blog_vuepress/assets/img/bg2015091502.eac82689.png" alt="render"></p> <h4 id="重绘与重排"><a href="#重绘与重排" class="header-anchor">#</a> 重绘与重排</h4> <p>在了解完网页的生成过程后，我们就可以来讲一下重绘和重排了。
网页在生成的时候，至少会渲染一次。用户访问的过程中，还会不断地重新渲染。
常见的几种情况化导致网页的重新渲染：</p> <ul><li>修改 DOM</li> <li>修改 style</li> <li>用户事件。(click，mouseover...)</li></ul> <p>重新渲染的过程需要重新生成布局和重新绘制。
<strong>重新生成布局的过程称为重排(reflow)</strong>，<strong>重新绘制的过程称为重绘(repaint)</strong>。</p> <div class="custom-block warning"><p class="custom-block-title">Note</p> <p>重绘不一定会导致重排。例如：修改每一个 DOM 元素的<code>background-color</code>，这会导致页面的重绘。</p> <p>重排一定会导致重绘。例如我们修改了一个 DOM 元素的位置，它会触发网页的重绘和重排，因为布局发生改变了。</p></div> <p>重排的发生时机：</p> <ul><li>添加或删除可见的 DOM 元素</li> <li>元素位置发生改变</li> <li>元素的尺寸发生改变（包括：外边距，内边距，边框厚度，宽度，高度等属性）</li> <li>内容发生改变。例如：文本发生改变或者图片被另一张不同尺寸的图片替换。</li> <li>页面渲染初始化</li> <li>浏览器窗口发生改变</li></ul> <p>总之，涉及到元素变化都会发生重排（可以通过某些技术避免）。</p> <h4 id="性能的影响"><a href="#性能的影响" class="header-anchor">#</a> 性能的影响</h4> <p>重绘和重排是不可避免的。但是它们确是非常消耗性能的，想要提高网页的性能就必须尽可能地减少重绘和重排的次数。
考虑下面的例子：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>div<span class="token punctuation">.</span>style<span class="token punctuation">.</span>color <span class="token operator">=</span> <span class="token string">'lightgreen'</span>
div<span class="token punctuation">.</span>style<span class="token punctuation">.</span>marginTop <span class="token operator">=</span> <span class="token string">'50px'</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>上面的代码会发生两次样式的改变，但是浏览器只会触发一次重绘和重排，这是因为现代浏览器已经对页面元素的修改尽可能集中在一起，排成一个队列然后一次性执行，从而避免多次重新渲染。</p> <p>但是，如果中间操作不当，仍然会发生多次的重绘和重排：</p> <div class="language-js line-numbers-mode"><div class="highlight-lines"><br><div class="highlighted"> </div><br><br></div><pre class="language-js"><code>div<span class="token punctuation">.</span>style<span class="token punctuation">.</span>color <span class="token operator">=</span> <span class="token string">'lightgreen'</span>
<span class="token keyword">const</span> mt <span class="token operator">=</span> <span class="token function">parseInt</span><span class="token punctuation">(</span>div<span class="token punctuation">.</span>style<span class="token punctuation">.</span>marginTop<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">10</span>
div<span class="token punctuation">.</span>style<span class="token punctuation">.</span>marginTop <span class="token operator">=</span> `$<span class="token punctuation">{</span>mt<span class="token punctuation">}</span>px'
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>由于我们在第 2 行代码中获取元素的属性，导致浏览器<strong>不得不</strong>立刻执行重排以确保获取到的元素属性是实时的。但是这样做就导致额外的重新渲染了。</p> <p>所以，从性能的角度上看，尽可能把读写操作分开，可以有效减少重新渲染的次数。例如：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// bad</span>
<span class="token comment">// 这里会发生3次重排</span>
<span class="token comment">// 1. 获取div.offsetLeft</span>
<span class="token comment">// 2. 获取div.offsetTop。(div.style.left会在此次进行重排)</span>
<span class="token comment">// 3. 修改div.style.top。</span>
div<span class="token punctuation">.</span>style<span class="token punctuation">.</span>left <span class="token operator">=</span> div<span class="token punctuation">.</span>offsetLeft <span class="token operator">+</span> <span class="token number">10</span> <span class="token operator">+</span> <span class="token string">'px'</span>
div<span class="token punctuation">.</span>style<span class="token punctuation">.</span>top <span class="token operator">=</span> div<span class="token punctuation">.</span>offsetTop <span class="token operator">+</span> <span class="token number">10</span> <span class="token operator">+</span> <span class="token string">'px'</span>

<span class="token comment">// good</span>
<span class="token comment">// 这里只会发生两次重排</span>
<span class="token comment">// 1. 获取页面元素属性</span>
<span class="token comment">// 2. 修改页面元素属性</span>
<span class="token keyword">const</span> offsetLeft <span class="token operator">=</span> div<span class="token punctuation">.</span>offsetLeft
<span class="token keyword">const</span> offsetTop <span class="token operator">=</span> div<span class="token punctuation">.</span>offsetTop

div<span class="token punctuation">.</span>style<span class="token punctuation">.</span>left <span class="token operator">=</span> offsetLeft <span class="token operator">+</span> <span class="token number">10</span> <span class="token operator">+</span> <span class="token string">'px'</span>
div<span class="token punctuation">.</span>style<span class="token punctuation">.</span>top <span class="token operator">=</span> offsetTop <span class="token operator">+</span> <span class="token number">10</span> <span class="token operator">+</span> <span class="token string">'px'</span>

<span class="token comment">// better</span>
<span class="token comment">// 我们可以将修改页面元素属性放在同一个操作中，以确保只会发生一次重新渲染。</span>
<span class="token keyword">const</span> offsetLeft <span class="token operator">=</span> div<span class="token punctuation">.</span>offsetLeft
<span class="token keyword">const</span> offsetTop <span class="token operator">=</span> div<span class="token punctuation">.</span>offsetTop

div<span class="token punctuation">.</span>style <span class="token operator">+=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">left: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>offsetLeft <span class="token operator">+</span> <span class="token number">10</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">px; top: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>offsetTop <span class="token operator">+</span> <span class="token number">10</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">px;</span><span class="token template-punctuation string">`</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><h4 id="优化"><a href="#优化" class="header-anchor">#</a> 优化</h4> <p>下面我们列举一些有用的优化方案：</p> <ol><li>对 DOM 的多次读/写操作放在一起。正如我们上述看到的，对 DOM 多次的读/写操作放在一起可以有效地减少网页的重新渲染。</li> <li>离线修改 DOM 元素。例如：
<ul><li>隐藏元素，执行修改操作，再将 DOM 放回文档中。</li> <li>使用文档片段（document fragment）在当前 DOM 之外构建一个子树，再把它的拷贝放回文档中。</li> <li>cloneNode。先复制结点，完成修改后，替换原先的结点。
例如：先将 DOM 元素设置为<code>display: none;</code>，这样需要执行 1 次重绘和重绘，之后再对 DOM 元素进行任意次修改，然后再将<code>dispaly</code>设置回原先的状态（这样又放生了 1 次重绘和重排），总共需要 2 次重绘和重排，而中间的修改不会发生重绘和重排。</li></ul></li> <li>不要一条条地修改样式，可以通过改变 DOM 元素的<code>class</code>或者 csstext 属性，一次性地修改样式。例如：</li> <li>将<code>position</code>属性设置为<code>absolute</code>或者<code>fixed</code>使 DOM 元素脱离文档流。</li> <li>使用虚拟 DOM</li> <li>使用<code>window.requestAnimationFrame()</code>、<code>window.requestIdleCallback()</code>调节重新渲染。</li></ol> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// bad</span>
div<span class="token punctuation">.</span>style<span class="token punctuation">.</span>left <span class="token operator">=</span> <span class="token number">10</span> <span class="token operator">+</span> <span class="token string">'px'</span>
div<span class="token punctuation">.</span>style<span class="token punctuation">.</span>right <span class="token operator">=</span> <span class="token number">10</span> <span class="token operator">+</span> <span class="token string">'px'</span>

<span class="token comment">// good</span>
<span class="token comment">// supports .active { left: 10px; right: 10px;}</span>
div<span class="token punctuation">.</span>className <span class="token operator">+=</span> <span class="token string">'active'</span>
<span class="token comment">// or</span>
div<span class="token punctuation">.</span>style <span class="token operator">+=</span> <span class="token string">'left: 10px; right: 10px;'</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h4 id="事件委托"><a href="#事件委托" class="header-anchor">#</a> 事件委托</h4> <p>当页面中存在大量元素，而且每一个都需要一次或多次绑定同一个事件处理器时（例如：click），
这种情况可能会影响性能。因为没绑定一个事件处理器都是有代价的，它要么是加重了页面的负担（需要更多的表用或者 js 代码），要么是增加运行的事件。</p> <p>一个可行的方案就是通过事件委托（event delegation）的方式进行优化。</p> <p>下面将一步步引出事件委托的妙用。在讲事件委托之前，先了解一些简单的概念。
事件捕获：自顶向下。
事件冒泡：自底向上。
我们常用的<code>el.addEventListener('event', callback)</code>默认就是采用事件冒泡的方式捕获事件，也可以传入第 3 个参数来决定是否使用事件冒泡。<code>el.addEventListener('event', callback, true)</code>采用事件捕获。</p> <p>了解完事件的捕获机制后，我们就可以来讨论一下事件委托了。来看下面的例子：</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>list<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span>1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span>2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span>3<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span>4<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span>5<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>如果我们想要对<code>li</code>添加一个<code>click</code>事件，最原始的方式就是通过<code>for</code>循环，为每一个<code>li</code>添加事件：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> list <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelectorAll</span><span class="token punctuation">(</span><span class="token string">'li'</span><span class="token punctuation">)</span>
Array<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span>list<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">el</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  el<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'click...'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>上面的方式确实没有问题，但是性能太差，但是我们可以用事件委托的方式来实现：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> ul <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'.list'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> list <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelectorAll</span><span class="token punctuation">(</span><span class="token string">'li'</span><span class="token punctuation">)</span>
ul<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> target <span class="token operator">=</span> e<span class="token punctuation">.</span>target
  <span class="token keyword">if</span> <span class="token punctuation">(</span>target<span class="token punctuation">.</span>tagName<span class="token punctuation">.</span><span class="token function">toLowerCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!==</span> <span class="token string">'li'</span><span class="token punctuation">)</span> <span class="token keyword">return</span>
  <span class="token keyword">const</span> index <span class="token operator">=</span> <span class="token class-name">Array</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>list<span class="token punctuation">,</span> target<span class="token punctuation">)</span>
  <span class="token function">alert</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">current li: index = </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>index<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>这里，我们是通过事件委托的方式来实现上面的功能。首先，我们先获取li对应的父元素<code>ul</code>，为<code>ul</code>添加<code>click</code>实现来实现事件委托机制。</p> <p>这里需要注意的是需要做一下判断。判断当前结点是否为<code>li</code>结点。这是因为我们想通过点击<code>li</code>来触发响应，但是实际的场景下一个<code>ul</code>结点中可能还包含其他结点，使用我们需要判断<code>target.tagName.toLowerCase() === 'li'</code></p> <p>了解完事件委托机制后，我们来看一下具体的开发场景：我们给每个用户添加了一个属性，<code>banned = true</code>，该用户点击页面上的任何按钮或者元素，都不可以响应原来的函数。而是直接<code>alert</code>提示，你被封禁了。</p> <p>一种可行的方案就是为整个页面添加一个透明的<code>cover</code>，这样用户点击实际上是点击我们创建的<code>cover</code>。另一种方案就是使用事件委托机制：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>banned <span class="token operator">===</span> <span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    e<span class="token punctuation">.</span><span class="token function">stopPropagation</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span> 
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h4 id="reference"><a href="#reference" class="header-anchor">#</a> reference</h4> <ul><li><a href="http://www.ruanyifeng.com/blog/2015/09/web-page-performance-in-depth.html" target="_blank" rel="noopener noreferrer">网页性能管理详解<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://www.bilibili.com/video/BV1zy4y1J7Sf" target="_blank" rel="noopener noreferrer">爪哇教育 2021 大厂前端核心面试题详解-路白<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <h3 id="事件委托-2"><a href="#事件委托-2" class="header-anchor">#</a> 事件委托</h3> <h2 id="算法与流程控制"><a href="#算法与流程控制" class="header-anchor">#</a> 算法与流程控制</h2> <h3 id="循环"><a href="#循环" class="header-anchor">#</a> 循环</h3> <h3 id="递归"><a href="#递归" class="header-anchor">#</a> 递归</h3> <h3 id="条件语句"><a href="#条件语句" class="header-anchor">#</a> 条件语句</h3> <h2 id="字符串与正则"><a href="#字符串与正则" class="header-anchor">#</a> 字符串与正则</h2> <h3 id="字符串"><a href="#字符串" class="header-anchor">#</a> 字符串</h3> <h3 id="正则优化"><a href="#正则优化" class="header-anchor">#</a> 正则优化</h3> <h2 id="快速响应的用户界面"><a href="#快速响应的用户界面" class="header-anchor">#</a> 快速响应的用户界面</h2> <h3 id="浏览器-ui-线程"><a href="#浏览器-ui-线程" class="header-anchor">#</a> 浏览器 UI 线程</h3> <h3 id="定时器"><a href="#定时器" class="header-anchor">#</a> 定时器</h3> <h3 id="web-workers"><a href="#web-workers" class="header-anchor">#</a> web workers</h3> <h2 id="ajax"><a href="#ajax" class="header-anchor">#</a> Ajax</h2> <h3 id="数据传输"><a href="#数据传输" class="header-anchor">#</a> 数据传输</h3> <h3 id="数据格式"><a href="#数据格式" class="header-anchor">#</a> 数据格式</h3> <h3 id="ajax-性能指南"><a href="#ajax-性能指南" class="header-anchor">#</a> Ajax 性能指南</h3></div> <footer class="page-meta"><!----> <div class="meta-item update-time"><span class="label">Last update:</span> <span class="info">April 8, 2021 21:31</span></div> <div class="meta-item contributors"><span class="label">Contributors: </span> <span class="info"><span title="email: 15622971239@163.com" class="contributor">
          Laishuxin
        </span> <!----></span></div></footer> <div class="page-nav"><p class="inner"><span class="prev"><a href="/Blog_vuepress/cate/fe_base/javascript_base/event_loop/" class="prev"><svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="icon prev-icon"><path d="M906.783 588.79c-.02 8.499-6.882 15.36-15.38 15.37l-443.7-.01 75.704 191.682c2.52 6.42.482 13.763-5.038 17.91-5.52 4.168-13.138 4.147-18.616-.092L123.228 524.175a15.362 15.362 0 0 1-6-12.165c0-4.782 2.222-9.277 6-12.185L499.753 210.35a15.388 15.388 0 0 1 9.38-3.195c3.236 0 6.502 1.034 9.236 3.103 5.52 4.147 7.578 11.49 5.038 17.91L447.683 419.84l443.72-.01c8.498.01 15.36 6.881 15.36 15.36l.02 153.6z" fill="currentColor"></path></svg>
        事件循环
      </a></span> <span class="next"><a href="/Blog_vuepress/cate/fe_base/javascript_base/inherit/">
        继承的几种方式及其优缺点
        <svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="icon next-icon"><path d="M906.772 512c0 4.772-2.211 9.267-5.99 12.175L524.257 813.66a15.37 15.37 0 0 1-18.616.092 15.368 15.368 0 0 1-5.038-17.91l75.714-191.672h-443.73c-8.488 0-15.36-6.881-15.36-15.36v-153.6c0-8.489 6.872-15.36 15.36-15.36h443.73l-75.714-191.682a15.358 15.358 0 0 1 5.048-17.91c5.51-4.158 13.128-4.137 18.606.092l376.525 289.485a15.323 15.323 0 0 1 5.99 12.165z" fill="currentColor"></path></svg></a></span></p></div> <!----> </main> <footer class="footer-wrapper"><!----> <div class="footer"><h2 style="width:100%; min-width: 100%;">Ru Shui</h2></div> <div class="copyright">MIT Licensed | Copyright © 2021-present Ru Shui</div></footer></div><div class="global-ui"><!----><!----><div id="pwa-install"><!----> <div id="install-modal-wrapper" style="display:none;"><div class="background"></div> <div class="install-modal"><div class="header"><button aria-label="Close" class="close-button"><svg width="23" height="22" xmlns="http://www.w3.org/2000/svg" class="icon close-icon"><path fill-rule="evenodd" clip-rule="evenodd" d="M1.12.358a1.224 1.224 0 011.729 0l8.92 8.914L20.686.358a1.224 1.224 0 011.73 1.728L13.497 11l8.92 8.913a1.222 1.222 0 11-1.73 1.729l-8.919-8.913-8.92 8.913a1.224 1.224 0 01-1.729-1.729L10.04 11l-8.92-8.914a1.222 1.222 0 010-1.728z" fill="currentColor"></path></svg></button> <div class="logo"><!----> <div class="title"><h1></h1> <p class="desc">This app can be installed on your PC or mobile device.  This will allow this web app to look and behave like any other installed app.  You will find it in your app lists and be able to pin it to your home screen, start menus or task bars.  This installed web app will also be able to safely interact with other apps and your operating system. </p></div></div></div> <div class="content"><div class="highlight"><!----> <!----></div> <div class="description"><h3>Description</h3> <p></p></div></div> <div class="button-wrapper"><button class="install-button">
        Install <span></span></button> <button class="cancel-button">
        Cancel
      </button></div></div></div></div><div tabindex="-1" role="dialog" aria-hidden="true" class="pswp"><div class="pswp__bg"></div> <div class="pswp__scroll-wrap"><div class="pswp__container"><div class="pswp__item"></div> <div class="pswp__item"></div> <div class="pswp__item"></div></div> <div class="pswp__ui pswp__ui--hidden"><div class="pswp__top-bar"><div class="pswp__counter"></div> <button title="Close (Esc)" class="pswp__button pswp__button--close"></button> <button title="Share" class="pswp__button pswp__button--share"></button> <button title="Toggle fullscreen" class="pswp__button pswp__button--fs"></button> <button title="Zoom in/out" class="pswp__button pswp__button--zoom"></button> <div class="pswp__preloader"><div class="pswp__preloader__icn"><div class="pswp__preloader__cut"><div class="pswp__preloader__donut"></div></div></div></div></div> <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class="pswp__share-tooltip"></div></div> <button title="Previous (arrow left)" class="pswp__button pswp__button--arrow--left"></button> <button title="Next (arrow right)" class="pswp__button pswp__button--arrow--right"></button> <div class="pswp__caption"><div class="pswp__caption__center"></div></div></div></div></div></div></div>
    <script src="/Blog_vuepress/assets/js/app.61d23203.js" defer></script><script src="/Blog_vuepress/assets/js/layout-Layout.90c0d5fc.js" defer></script><script src="/Blog_vuepress/assets/js/vendors~layout-Blog~layout-Layout~layout-NotFound.ec13e494.js" defer></script><script src="/Blog_vuepress/assets/js/vendors~layout-Blog~layout-Layout~layout-NotFound~layout-Slide.3b3ec8cf.js" defer></script><script src="/Blog_vuepress/assets/js/vendors~layout-Blog~layout-Layout.d8d83bf7.js" defer></script><script src="/Blog_vuepress/assets/js/page-高性能javascript.272df5f7.js" defer></script>
  </body>
</html>
